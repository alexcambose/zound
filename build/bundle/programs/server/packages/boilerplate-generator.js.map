{"version":3,"sources":["meteor://ðŸ’»app/packages/boilerplate-generator/generator.js","meteor://ðŸ’»app/packages/boilerplate-generator/template-web.browser.js","meteor://ðŸ’»app/packages/boilerplate-generator/template-web.cordova.js","meteor://ðŸ’»app/packages/boilerplate-generator/template.js"],"names":["module","export","Boilerplate","readFile","watch","require","v","createStream","create","WebBrowserTemplate","default","WebCordovaTemplate","readUtf8FileSync","filename","Meteor","wrapAsync","identity","value","appendToStream","chunk","stream","append","Buffer","from","isBuffer","read","shouldWarnAboutToHTMLDeprecation","isProduction","constructor","arch","manifest","options","headTemplate","closeTemplate","getTemplate","baseData","_generateBoilerplateFromManifest","toHTML","extraData","console","error","trace","toHTMLAsync","await","Promise","resolve","reject","toHTMLStream","chunks","on","push","concat","toString","Error","data","start","body","dynamicBody","end","response","urlMapper","pathMapper","baseDataExtension","inline","boilerplateBaseData","css","js","head","meteorManifest","JSON","stringify","forEach","item","urlPath","url","itemObj","scriptContent","path","type","where","startsWith","prefix","split","join","template","htmlAttributes","bundledJsCssUrlRewriteHook","dynamicHead","headSections","cssBundle","map","file","href","Object","keys","key","attrName","attrValue","length","meteorRuntimeConfig","rootUrlPathPrefix","inlineScriptsAllowed","additionalStaticJs","conf","src","contents","pathname","_","text","evaluate","interpolate","escape"],"mappings":"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","file":"/packages/boilerplate-generator.js","sourcesContent":["import { readFile } from 'fs';\nimport { create as createStream } from \"combined-stream2\";\n\nimport WebBrowserTemplate from './template-web.browser';\nimport WebCordovaTemplate from './template-web.cordova';\n\n// Copied from webapp_server\nconst readUtf8FileSync = filename => Meteor.wrapAsync(readFile)(filename, 'utf8');\n\nconst identity = value => value;\n\nfunction appendToStream(chunk, stream) {\n  if (typeof chunk === \"string\") {\n    stream.append(Buffer.from(chunk, \"utf8\"));\n  } else if (Buffer.isBuffer(chunk) ||\n             typeof chunk.read === \"function\") {\n    stream.append(chunk);\n  }\n}\n\nlet shouldWarnAboutToHTMLDeprecation = ! Meteor.isProduction;\n\nexport class Boilerplate {\n  constructor(arch, manifest, options = {}) {\n    const { headTemplate, closeTemplate } = getTemplate(arch);\n    this.headTemplate = headTemplate;\n    this.closeTemplate = closeTemplate;\n    this.baseData = null;\n\n    this._generateBoilerplateFromManifest(\n      manifest,\n      options\n    );\n  }\n\n  toHTML(extraData) {\n    if (shouldWarnAboutToHTMLDeprecation) {\n      shouldWarnAboutToHTMLDeprecation = false;\n      console.error(\n        \"The Boilerplate#toHTML method has been deprecated. \" +\n          \"Please use Boilerplate#toHTMLStream instead.\"\n      );\n      console.trace();\n    }\n\n    // Calling .await() requires a Fiber.\n    return this.toHTMLAsync(extraData).await();\n  }\n\n  // Returns a Promise that resolves to a string of HTML.\n  toHTMLAsync(extraData) {\n    return new Promise((resolve, reject) => {\n      const stream = this.toHTMLStream(extraData);\n      const chunks = [];\n      stream.on(\"data\", chunk => chunks.push(chunk));\n      stream.on(\"end\", () => {\n        resolve(Buffer.concat(chunks).toString(\"utf8\"));\n      });\n      stream.on(\"error\", reject);\n    });\n  }\n\n  // The 'extraData' argument can be used to extend 'self.baseData'. Its\n  // purpose is to allow you to specify data that you might not know at\n  // the time that you construct the Boilerplate object. (e.g. it is used\n  // by 'webapp' to specify data that is only known at request-time).\n  // this returns a stream\n  toHTMLStream(extraData) {\n    if (!this.baseData || !this.headTemplate || !this.closeTemplate) {\n      throw new Error('Boilerplate did not instantiate correctly.');\n    }\n\n    const data = {...this.baseData, ...extraData};\n    const start = \"<!DOCTYPE html>\\n\" + this.headTemplate(data);\n\n    const { body, dynamicBody } = data;\n\n    const end = this.closeTemplate(data);\n    const response = createStream();\n\n    appendToStream(start, response);\n\n    if (body) {\n      appendToStream(body, response);\n    }\n\n    if (dynamicBody) {\n      appendToStream(dynamicBody, response);\n    }\n\n    appendToStream(end, response);\n\n    return response;\n  }\n\n  // XXX Exported to allow client-side only changes to rebuild the boilerplate\n  // without requiring a full server restart.\n  // Produces an HTML string with given manifest and boilerplateSource.\n  // Optionally takes urlMapper in case urls from manifest need to be prefixed\n  // or rewritten.\n  // Optionally takes pathMapper for resolving relative file system paths.\n  // Optionally allows to override fields of the data context.\n  _generateBoilerplateFromManifest(manifest, {\n    urlMapper = identity,\n    pathMapper = identity,\n    baseDataExtension,\n    inline,\n  } = {}) {\n\n    const boilerplateBaseData = {\n      css: [],\n      js: [],\n      head: '',\n      body: '',\n      meteorManifest: JSON.stringify(manifest),\n      ...baseDataExtension,\n    };\n\n    manifest.forEach(item => {\n      const urlPath = urlMapper(item.url);\n      const itemObj = { url: urlPath };\n\n      if (inline) {\n        itemObj.scriptContent = readUtf8FileSync(\n          pathMapper(item.path));\n        itemObj.inline = true;\n      }\n\n      if (item.type === 'css' && item.where === 'client') {\n        boilerplateBaseData.css.push(itemObj);\n      }\n\n      if (item.type === 'js' && item.where === 'client' &&\n        // Dynamic JS modules should not be loaded eagerly in the\n        // initial HTML of the app.\n        !item.path.startsWith('dynamic/')) {\n        boilerplateBaseData.js.push(itemObj);\n      }\n\n      if (item.type === 'head') {\n        boilerplateBaseData.head =\n          readUtf8FileSync(pathMapper(item.path));\n      }\n\n      if (item.type === 'body') {\n        boilerplateBaseData.body =\n          readUtf8FileSync(pathMapper(item.path));\n      }\n    });\n\n    this.baseData = boilerplateBaseData;\n  }\n};\n\n// Returns a template function that, when called, produces the boilerplate\n// html as a string.\nfunction getTemplate(arch) {\n  const prefix = arch.split(\".\", 2).join(\".\");\n\n  if (prefix === \"web.browser\") {\n    return WebBrowserTemplate;\n  }\n\n  if (prefix === \"web.cordova\") {\n    return WebCordovaTemplate;\n  }\n\n  throw new Error(\"Unsupported arch: \" + arch);\n}\n","import template from './template';\n\nexport const headTemplate = ({\n  css,\n  htmlAttributes,\n  bundledJsCssUrlRewriteHook,\n  head,\n  dynamicHead,\n}) => {\n  var headSections = head.split(/<meteor-bundled-css[^<>]*>/, 2);\n  var cssBundle = [...(css || []).map(file =>\n    template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\">')({\n      href: bundledJsCssUrlRewriteHook(file.url),\n    })\n  )].join('\\n');\n\n  return [\n    '<html' + Object.keys(htmlAttributes || {}).map(\n      key => template(' <%= attrName %>=\"<%- attrValue %>\"')({\n        attrName: key,\n        attrValue: htmlAttributes[key],\n      })\n    ).join('') + '>',\n    \n    '<head>',\n\n    (headSections.length === 1)\n      ? [cssBundle, headSections[0]].join('\\n')\n      : [headSections[0], cssBundle, headSections[1]].join('\\n'),\n\n    dynamicHead,\n    '</head>',\n    '<body>',\n  ].join('\\n');\n};\n\n// Template function for rendering the boilerplate html for browsers\nexport const closeTemplate = ({\n  meteorRuntimeConfig,\n  rootUrlPathPrefix,\n  inlineScriptsAllowed,\n  js,\n  additionalStaticJs,\n  bundledJsCssUrlRewriteHook,\n}) => [\n  '',\n  inlineScriptsAllowed\n    ? template('  <script type=\"text/javascript\">__meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>))</script>')({\n      conf: meteorRuntimeConfig,\n    })\n    : template('  <script type=\"text/javascript\" src=\"<%- src %>/meteor_runtime_config.js\"></script>')({\n      src: rootUrlPathPrefix,\n    }),\n  '',\n\n  ...(js || []).map(file =>\n    template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n      src: bundledJsCssUrlRewriteHook(file.url),\n    })\n  ),\n\n  ...(additionalStaticJs || []).map(({ contents, pathname }) => (\n    inlineScriptsAllowed\n      ? template('  <script><%= contents %></script>')({\n        contents,\n      })\n      : template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n        src: rootUrlPathPrefix + pathname,\n      })\n  )),\n\n  '',\n  '',\n  '</body>',\n  '</html>'\n].join('\\n');\n","import template from './template';\n\n// Template function for rendering the boilerplate html for cordova\nexport const headTemplate = ({\n  meteorRuntimeConfig,\n  rootUrlPathPrefix,\n  inlineScriptsAllowed,\n  css,\n  js,\n  additionalStaticJs,\n  htmlAttributes,\n  bundledJsCssUrlRewriteHook,\n  head,\n  dynamicHead,\n}) => {\n  var headSections = head.split(/<meteor-bundled-css[^<>]*>/, 2);\n  var cssBundle = [\n    // We are explicitly not using bundledJsCssUrlRewriteHook: in cordova we serve assets up directly from disk, so rewriting the URL does not make sense\n    ...(css || []).map(file =>\n      template('  <link rel=\"stylesheet\" type=\"text/css\" class=\"__meteor-css__\" href=\"<%- href %>\">')({\n        href: file.url,\n      })\n  )].join('\\n');\n\n  return [\n    '<html>',\n    '<head>',\n    '  <meta charset=\"utf-8\">',\n    '  <meta name=\"format-detection\" content=\"telephone=no\">',\n    '  <meta name=\"viewport\" content=\"user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, viewport-fit=cover\">',\n    '  <meta name=\"msapplication-tap-highlight\" content=\"no\">',\n    '  <meta http-equiv=\"Content-Security-Policy\" content=\"default-src * gap: data: blob: \\'unsafe-inline\\' \\'unsafe-eval\\' ws: wss:;\">',\n\n  (headSections.length === 1)\n    ? [cssBundle, headSections[0]].join('\\n')\n    : [headSections[0], cssBundle, headSections[1]].join('\\n'),\n\n    '  <script type=\"text/javascript\">',\n    template('    __meteor_runtime_config__ = JSON.parse(decodeURIComponent(<%= conf %>));')({\n      conf: meteorRuntimeConfig,\n    }),\n    '    if (/Android/i.test(navigator.userAgent)) {',\n    // When Android app is emulated, it cannot connect to localhost,\n    // instead it should connect to 10.0.2.2\n    // (unless we\\'re using an http proxy; then it works!)\n    '      if (!__meteor_runtime_config__.httpProxyPort) {',\n    '        __meteor_runtime_config__.ROOT_URL = (__meteor_runtime_config__.ROOT_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');',\n    '        __meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL = (__meteor_runtime_config__.DDP_DEFAULT_CONNECTION_URL || \\'\\').replace(/localhost/i, \\'10.0.2.2\\');',\n    '      }',\n    '    }',\n    '  </script>',\n    '',\n    '  <script type=\"text/javascript\" src=\"/cordova.js\"></script>',\n\n    ...(js || []).map(file =>\n      template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n        src: file.url,\n      })\n    ),\n\n    ...(additionalStaticJs || []).map(({ contents, pathname }) => (\n      inlineScriptsAllowed\n        ? template('  <script><%= contents %></script>')({\n          contents,\n        })\n        : template('  <script type=\"text/javascript\" src=\"<%- src %>\"></script>')({\n          src: rootUrlPathPrefix + pathname\n        })\n    )),\n    '',\n    head,\n    '</head>',\n    '',\n    '<body>',\n  ].join('\\n');\n};\n\nexport function closeTemplate() {\n  return \"</body>\\n</html>\";\n}\n","import { _ } from 'meteor/underscore';\n\n// As identified in issue #9149, when an application overrides the default\n// _.template settings using _.templateSettings, those new settings are\n// used anywhere _.template is used, including within the\n// boilerplate-generator. To handle this, _.template settings that have\n// been verified to work are overridden here on each _.template call.\nexport default function template(text) {\n  return _.template(text, null, {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g,\n  });\n};\n"]}